<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Novel Reader - ƒê·ªçc truy·ªán offline">
    <meta name="theme-color" content="#6366f1">
    <title>Novel Reader</title>
    <link rel="manifest" href="manifest.json?v=4.1">
    <link rel="stylesheet" href="styles.css?v=4.1">
    <link rel="stylesheet" href="auth-modal.css?v=4.1">
    <!-- Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a class="nav-title" href="./" title="V·ªÅ trang ch·ªß">üìö Novel Reader</a>
            <div class="nav-actions">
                <div id="userInfo" class="user-info hidden">
                    <span id="usernameDisplay"></span>
                    <button id="logoutBtn" class="btn-logout">ƒêƒÉng xu·∫•t</button>
                </div>
                <button id="loginBtn" class="btn-login">ƒêƒÉng nh·∫≠p</button>
                <button class="nav-menu-btn" id="menuBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="loginModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</h2>
                <button class="modal-close" id="closeLoginModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">ƒêƒÉng nh·∫≠p</button>
                    <button class="tab-btn" data-tab="register">ƒêƒÉng k√Ω</button>
                </div>
                <form id="loginForm" class="auth-form">
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">ƒêƒÉng nh·∫≠p</button>
                    <div id="loginError" class="error-message"></div>
                </form>
                <form id="registerForm" class="auth-form hidden">
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="registerUsername" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">ƒêƒÉng k√Ω</button>
                    <div id="registerError" class="error-message"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>Th∆∞ vi·ªán</h2>
            <button class="close-btn" id="closeBtn">&times;</button>
        </div>
        <div class="sidebar-content">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="T√¨m truy·ªán...">
            </div>
            <div class="novel-list" id="novelList">
                <div class="loading">ƒêang t·∫£i...</div>
            </div>
        </div>
    </aside>
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main Content - Router will populate this -->
    <main class="main-content" id="mainContent">
        <!-- Home View - Router will load content here -->
        <div class="view" id="homeView"></div>

        <!-- Novel Detail View -->
        <div class="view hidden" id="novelDetailView">
            <div class="novel-header">
                <h2 id="novelTitle"></h2>
                <p class="novel-meta" id="novelMeta"></p>
            </div>
            <div class="chapter-list" id="chapterList">
                <div class="loading">ƒêang t·∫£i...</div>
            </div>
        </div>

        <!-- Reader View -->
        <div class="view hidden" id="readerView">
            <div class="reader-header">
                <button class="back-btn" id="backBtn">‚Üê Quay l·∫°i</button>
                <div class="header-settings">
                    <button class="control-btn" id="homeBtn" title="V·ªÅ trang ch·ªß">üè†</button>
                    <div class="font-controls">
                        <button class="font-btn" id="decreaseFont">A-</button>
                        <span id="fontSize">16</span>
                        <button class="font-btn" id="increaseFont">A+</button>
                    </div>
                    <button class="theme-toggle" id="themeToggle">üåô</button>
                </div>
            </div>
            <div class="reader-content">
                <h1 id="chapterTitle"></h1>
                <div id="chapterContent"></div>
            </div>
            <div class="reader-footer">
                <button class="control-btn control-btn-large" id="prevChapterBtn">‚Üê Ch∆∞∆°ng tr∆∞·ªõc</button>
                <button class="chapter-list-btn" id="chapterListBtn" title="Ch·ªçn ch∆∞∆°ng">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="8" y1="6" x2="21" y2="6"></line>
                        <line x1="8" y1="12" x2="21" y2="12"></line>
                        <line x1="8" y1="18" x2="21" y2="18"></line>
                        <line x1="3" y1="6" x2="3.01" y2="6"></line>
                        <line x1="3" y1="12" x2="3.01" y2="12"></line>
                        <line x1="3" y1="18" x2="3.01" y2="18"></line>
                    </svg>
                </button>
                <button class="control-btn control-btn-large" id="nextChapterBtn">Ch∆∞∆°ng sau ‚Üí</button>
            </div>
            
            <!-- Chapter List Modal -->
            <div class="chapter-list-modal hidden" id="chapterListModal">
                <div class="chapter-list-modal-overlay" id="chapterListModalOverlay"></div>
                <div class="chapter-list-modal-content">
                    <div class="chapter-list-modal-header">
                        <h3>Ch·ªçn ch∆∞∆°ng</h3>
                        <button class="chapter-list-modal-close" id="closeChapterListModal">&times;</button>
                    </div>
                    <div class="chapter-list-modal-body">
                        <input type="text" id="chapterSearchInput" class="chapter-search-input" placeholder="T√¨m ch∆∞∆°ng...">
                        <div class="chapter-list-scroll" id="chapterListScroll">
                            <div class="chapter-list-items" id="chapterListItems">
                                <div class="loading">ƒêang t·∫£i...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Toast Notification -->
    <div class="toast hidden" id="toast"></div>

    <!-- Override API/static paths for GitHub Pages -->
    <script>
        // Force static data on GitHub Pages (no backend)
        window.API_BASE_URL = '';
        window.STATIC_DATA_BASE = `${window.location.origin}/doctruyentest/data`;
    </script>

    <!-- Auto Update System - T·ª± ƒë·ªông ph√°t hi·ªán v√† reload khi c√≥ thay ƒë·ªïi -->
    <script src="js/auto-update.js?v=4.1"></script>
    
    <!-- Load legacy scripts first -->
    <script src="auth.js?v=4.1"></script>
    <script src="user-features.js?v=4.1"></script>
    
    <!-- Load main app - Router will handle everything -->
    <script type="module" src="js/app.js?v=4.1"></script>
</body>
</html>

